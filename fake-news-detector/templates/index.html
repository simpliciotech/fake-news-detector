<!doctype html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Fake News Detector</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  </head>
  <body class="bg-light">
    <div class="container py-5">
      <div class="row justify-content-center">
        <div class="col-md-8">
          <div class="card shadow-sm">
            <div class="card-body">
              <h1 class="h3 mb-3">üì∞ Fake News Detector</h1>
              <p class="text-muted">Insira um texto abaixo para analisar se pode ser <strong>fake</strong> ou <strong>real</strong>.</p>
              <div class="mb-3">
                <label for="newsText" class="form-label">Texto</label>
                <textarea id="newsText" class="form-control" rows="6" placeholder="Cole aqui a not√≠cia..."></textarea>
              </div>
              <div class="d-flex gap-2">
                <button id="analyzeBtn" class="btn btn-primary">Analisar</button>
                <button id="clearBtn" class="btn btn-outline-secondary">Limpar</button>
              </div>
              <hr class="my-4"/>
              <div id="result" class="alert d-none" role="alert"></div>
            </div>
            <div class="card-footer text-muted small">
              * Este projeto √© um prot√≥tipo para fins educacionais.
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      const btn = document.getElementById('analyzeBtn');
      const clearBtn = document.getElementById('clearBtn');
      const textarea = document.getElementById('newsText');
      const result = document.getElementById('result');

      clearBtn.addEventListener('click', () => {
        textarea.value = '';
        result.className = 'alert d-none';
        result.textContent = '';
      });

      btn.addEventListener('click', async () => {
        const text = textarea.value.trim();
        if (!text) {
          result.className = 'alert alert-warning';
          result.textContent = 'Por favor, digite um texto.';
          return;
        }
        result.className = 'alert alert-info';
        result.textContent = 'Analisando...';

        try {
          const res = await fetch('/predict', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({ text })
          });
          const data = await res.json();
          if (!data.ok) {
            result.className = 'alert alert-danger';
            result.textContent = data.error || 'Erro ao analisar.';
            return;
          }
          const label = data.prediction;
          const conf = data.confidence !== null ? ` (confian√ßa: ${(data.confidence*100).toFixed(1)}%)` : '';
          result.className = label === 'fake' ? 'alert alert-danger' : 'alert alert-success';
          result.textContent = `Predi√ß√£o: ${label}${conf}`;
        } catch (e) {
          result.className = 'alert alert-danger';
          result.textContent = 'Erro ao conectar √† API.';
        }
      });
    </script>
  </body>
</html>